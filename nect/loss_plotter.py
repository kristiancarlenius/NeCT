import re
import matplotlib.pyplot as plt
from collections import defaultdict
import numpy as np


# Input log as a multiline string
log_data = """epoch=0, avg_loss=0.384475
epoch=1, avg_loss=0.384422
epoch=2, avg_loss=0.384223
epoch=3, avg_loss=0.384108
epoch=4, avg_loss=0.383744
epoch=5, avg_loss=0.382930
epoch=6, avg_loss=0.381146
epoch=7, avg_loss=0.376213
epoch=8, avg_loss=0.359375
epoch=9, avg_loss=0.283894
epoch=10, avg_loss=0.123386
epoch=11, avg_loss=0.079142
epoch=12, avg_loss=0.034940
epoch=13, avg_loss=0.016924
epoch=14, avg_loss=0.011979
epoch=15, avg_loss=0.011514
epoch=16, avg_loss=0.011435
epoch=17, avg_loss=0.011184
epoch=18, avg_loss=0.011036
epoch=19, avg_loss=0.011300
epoch=20, avg_loss=0.010634
epoch=21, avg_loss=0.010089
epoch=22, avg_loss=0.009945
epoch=23, avg_loss=0.009094
epoch=24, avg_loss=0.008742
epoch=25, avg_loss=0.008763
epoch=26, avg_loss=0.007957
epoch=27, avg_loss=0.008322
epoch=28, avg_loss=0.007725
epoch=29, avg_loss=0.007593
epoch=30, avg_loss=0.007309
epoch=31, avg_loss=0.007456
epoch=32, avg_loss=0.007105
epoch=33, avg_loss=0.007152
epoch=34, avg_loss=0.006859
epoch=35, avg_loss=0.006957
epoch=36, avg_loss=0.006744
epoch=37, avg_loss=0.006550
epoch=38, avg_loss=0.006829
epoch=39, avg_loss=0.006376
epoch=40, avg_loss=0.006585
epoch=41, avg_loss=0.006079
epoch=42, avg_loss=0.006309
epoch=43, avg_loss=0.006067
epoch=44, avg_loss=0.005799
epoch=45, avg_loss=0.005995
epoch=46, avg_loss=0.005684
epoch=47, avg_loss=0.005672
epoch=48, avg_loss=0.005773
epoch=49, avg_loss=0.005609
epoch=50, avg_loss=0.005611
epoch=51, avg_loss=0.005311
epoch=52, avg_loss=0.005283
epoch=53, avg_loss=0.005233
epoch=54, avg_loss=0.005137
epoch=55, avg_loss=0.005236
epoch=56, avg_loss=0.005112
epoch=57, avg_loss=0.005157
epoch=58, avg_loss=0.005171
epoch=59, avg_loss=0.004991
epoch=60, avg_loss=0.005087
epoch=61, avg_loss=0.004812
epoch=62, avg_loss=0.004946
epoch=63, avg_loss=0.004860
epoch=64, avg_loss=0.004720
epoch=65, avg_loss=0.004792
epoch=66, avg_loss=0.004899
epoch=67, avg_loss=0.004676
epoch=68, avg_loss=0.004891
epoch=69, avg_loss=0.004577
epoch=70, avg_loss=0.004645
epoch=71, avg_loss=0.004595
epoch=72, avg_loss=0.004584
epoch=73, avg_loss=0.004631
epoch=74, avg_loss=0.004534
epoch=75, avg_loss=0.004502
epoch=76, avg_loss=0.004565
epoch=77, avg_loss=0.004464
epoch=78, avg_loss=0.004415
epoch=79, avg_loss=0.004403
epoch=80, avg_loss=0.004526
epoch=81, avg_loss=0.004258
epoch=82, avg_loss=0.004319
epoch=83, avg_loss=0.004419
epoch=84, avg_loss=0.004263
epoch=85, avg_loss=0.004245
epoch=86, avg_loss=0.004388
epoch=87, avg_loss=0.004324
epoch=88, avg_loss=0.004210
epoch=89, avg_loss=0.004150
epoch=90, avg_loss=0.004237
epoch=91, avg_loss=0.004096
epoch=92, avg_loss=0.004172
epoch=93, avg_loss=0.004196
epoch=94, avg_loss=0.004234
epoch=95, avg_loss=0.004247
epoch=96, avg_loss=0.004102
epoch=97, avg_loss=0.004114
epoch=98, avg_loss=0.004079
epoch=99, avg_loss=0.004126
epoch=100, avg_loss=0.004030
epoch=101, avg_loss=0.003995
epoch=102, avg_loss=0.004025
epoch=103, avg_loss=0.003904
epoch=104, avg_loss=0.004023
epoch=105, avg_loss=0.003952
epoch=106, avg_loss=0.003931
epoch=107, avg_loss=0.003844
epoch=108, avg_loss=0.003925
epoch=109, avg_loss=0.003878
epoch=110, avg_loss=0.003853
epoch=111, avg_loss=0.003875
epoch=112, avg_loss=0.003916
epoch=113, avg_loss=0.003813
epoch=114, avg_loss=0.003859
epoch=115, avg_loss=0.003848
epoch=116, avg_loss=0.003807
epoch=117, avg_loss=0.003864
epoch=118, avg_loss=0.003770
epoch=119, avg_loss=0.003772
epoch=120, avg_loss=0.003732
epoch=121, avg_loss=0.003678
epoch=122, avg_loss=0.003772
epoch=123, avg_loss=0.003669
epoch=124, avg_loss=0.003771
epoch=125, avg_loss=0.003641
epoch=126, avg_loss=0.003653
epoch=127, avg_loss=0.003672
epoch=128, avg_loss=0.003621
epoch=129, avg_loss=0.003732
epoch=130, avg_loss=0.003714
epoch=131, avg_loss=0.003633
epoch=132, avg_loss=0.003600
epoch=133, avg_loss=0.003606
epoch=134, avg_loss=0.003623
epoch=135, avg_loss=0.003528
epoch=136, avg_loss=0.003603
epoch=137, avg_loss=0.003578
epoch=138, avg_loss=0.003560
epoch=139, avg_loss=0.003523
epoch=140, avg_loss=0.003643
epoch=141, avg_loss=0.003514
epoch=142, avg_loss=0.003458
epoch=143, avg_loss=0.003632
epoch=144, avg_loss=0.003544
epoch=145, avg_loss=0.003563
epoch=146, avg_loss=0.003443
epoch=147, avg_loss=0.003526
epoch=148, avg_loss=0.003511
epoch=149, avg_loss=0.003504
epoch=150, avg_loss=0.003405
epoch=151, avg_loss=0.003401
epoch=152, avg_loss=0.003438
epoch=153, avg_loss=0.003496
epoch=154, avg_loss=0.003408
epoch=155, avg_loss=0.003469
epoch=156, avg_loss=0.003411
epoch=157, avg_loss=0.003396
epoch=158, avg_loss=0.003425
epoch=159, avg_loss=0.003364
epoch=160, avg_loss=0.003458
epoch=161, avg_loss=0.003378
epoch=162, avg_loss=0.003333
epoch=163, avg_loss=0.003437
epoch=164, avg_loss=0.003275
epoch=165, avg_loss=0.003362
epoch=166, avg_loss=0.003295
epoch=167, avg_loss=0.003355
epoch=168, avg_loss=0.003344
epoch=169, avg_loss=0.003320
epoch=170, avg_loss=0.003377
epoch=171, avg_loss=0.003291
epoch=172, avg_loss=0.003351
epoch=173, avg_loss=0.003271
epoch=174, avg_loss=0.003290
epoch=175, avg_loss=0.003326
epoch=176, avg_loss=0.003267
epoch=177, avg_loss=0.003266
epoch=178, avg_loss=0.003280
epoch=179, avg_loss=0.003288
epoch=180, avg_loss=0.003247
epoch=181, avg_loss=0.003253
epoch=182, avg_loss=0.003233
epoch=183, avg_loss=0.003325
epoch=184, avg_loss=0.003242
epoch=185, avg_loss=0.003189
epoch=186, avg_loss=0.003269
epoch=187, avg_loss=0.003183
epoch=188, avg_loss=0.003183
epoch=189, avg_loss=0.003225
epoch=190, avg_loss=0.003205
epoch=191, avg_loss=0.003274
epoch=192, avg_loss=0.003210
epoch=193, avg_loss=0.003154
epoch=194, avg_loss=0.003185
epoch=195, avg_loss=0.003149
epoch=196, avg_loss=0.003186
epoch=197, avg_loss=0.003167
epoch=198, avg_loss=0.003282
epoch=199, avg_loss=0.003118
epoch=200, avg_loss=0.003108
epoch=201, avg_loss=0.003157
epoch=202, avg_loss=0.003126
epoch=203, avg_loss=0.003152
epoch=204, avg_loss=0.003146
epoch=205, avg_loss=0.003106
epoch=206, avg_loss=0.003126
epoch=207, avg_loss=0.003103
epoch=208, avg_loss=0.003061
epoch=209, avg_loss=0.003128
epoch=210, avg_loss=0.003150
epoch=211, avg_loss=0.003053
epoch=212, avg_loss=0.003123
epoch=213, avg_loss=0.003047
epoch=214, avg_loss=0.003174
epoch=215, avg_loss=0.003018
epoch=216, avg_loss=0.003104
epoch=217, avg_loss=0.003106
epoch=218, avg_loss=0.003075
epoch=219, avg_loss=0.003074
epoch=220, avg_loss=0.003031
epoch=221, avg_loss=0.003089
epoch=222, avg_loss=0.003057
epoch=223, avg_loss=0.003099
epoch=224, avg_loss=0.003053
epoch=225, avg_loss=0.003047
epoch=226, avg_loss=0.003042
epoch=227, avg_loss=0.003065
epoch=228, avg_loss=0.003066
epoch=229, avg_loss=0.003044
epoch=230, avg_loss=0.003010
epoch=231, avg_loss=0.003000
epoch=232, avg_loss=0.003016
epoch=233, avg_loss=0.003017
epoch=234, avg_loss=0.003029
epoch=235, avg_loss=0.003011
epoch=236, avg_loss=0.003025
epoch=237, avg_loss=0.003000
epoch=238, avg_loss=0.003000
epoch=239, avg_loss=0.002989
epoch=240, avg_loss=0.003010
epoch=241, avg_loss=0.002968
epoch=242, avg_loss=0.002976
epoch=243, avg_loss=0.002957
epoch=244, avg_loss=0.002973
epoch=245, avg_loss=0.003004
epoch=246, avg_loss=0.002946
epoch=247, avg_loss=0.002967
epoch=248, avg_loss=0.002959
epoch=249, avg_loss=0.002971
epoch=250, avg_loss=0.002964
epoch=251, avg_loss=0.002977
epoch=252, avg_loss=0.002950
epoch=253, avg_loss=0.002969
epoch=254, avg_loss=0.002933
epoch=255, avg_loss=0.002988
epoch=256, avg_loss=0.002928
epoch=257, avg_loss=0.002945
epoch=258, avg_loss=0.002978
epoch=259, avg_loss=0.002886
epoch=260, avg_loss=0.002915
epoch=261, avg_loss=0.002932
epoch=262, avg_loss=0.002944
epoch=263, avg_loss=0.002972
epoch=264, avg_loss=0.002924
epoch=265, avg_loss=0.002895
epoch=266, avg_loss=0.002946
epoch=267, avg_loss=0.002880
epoch=268, avg_loss=0.002949
epoch=269, avg_loss=0.002917
epoch=270, avg_loss=0.002919
epoch=271, avg_loss=0.002922
epoch=272, avg_loss=0.002882
epoch=273, avg_loss=0.002892
epoch=274, avg_loss=0.002864
epoch=275, avg_loss=0.002909
epoch=276, avg_loss=0.002895
epoch=277, avg_loss=0.002900
epoch=278, avg_loss=0.002869
epoch=279, avg_loss=0.002867
epoch=280, avg_loss=0.002880
epoch=281, avg_loss=0.002856
epoch=282, avg_loss=0.002869
epoch=283, avg_loss=0.002850
epoch=284, avg_loss=0.002865
epoch=285, avg_loss=0.002868
epoch=286, avg_loss=0.002849
epoch=287, avg_loss=0.002876
epoch=288, avg_loss=0.002820
epoch=289, avg_loss=0.002812
epoch=290, avg_loss=0.002834
epoch=291, avg_loss=0.002856
epoch=292, avg_loss=0.002820
epoch=293, avg_loss=0.002864
epoch=294, avg_loss=0.002813
epoch=295, avg_loss=0.002841
epoch=296, avg_loss=0.002868
epoch=297, avg_loss=0.002828
epoch=298, avg_loss=0.002842
epoch=299, avg_loss=0.002806
epoch=300, avg_loss=0.002825
epoch=301, avg_loss=0.002841
epoch=302, avg_loss=0.002810
epoch=303, avg_loss=0.002858
epoch=304, avg_loss=0.002807
epoch=305, avg_loss=0.002784
epoch=306, avg_loss=0.002814
epoch=307, avg_loss=0.002803
epoch=308, avg_loss=0.002793
epoch=309, avg_loss=0.002847
epoch=310, avg_loss=0.002792
epoch=311, avg_loss=0.002788
epoch=312, avg_loss=0.002791
epoch=313, avg_loss=0.002822
epoch=314, avg_loss=0.002794
epoch=315, avg_loss=0.002786
epoch=316, avg_loss=0.002791
epoch=317, avg_loss=0.002780
epoch=318, avg_loss=0.002761
epoch=319, avg_loss=0.002765
epoch=320, avg_loss=0.002775
epoch=321, avg_loss=0.002793
epoch=322, avg_loss=0.002761
epoch=323, avg_loss=0.002759
epoch=324, avg_loss=0.002767
epoch=325, avg_loss=0.002725
epoch=326, avg_loss=0.002787
epoch=327, avg_loss=0.002758
epoch=328, avg_loss=0.002738
epoch=329, avg_loss=0.002757
epoch=330, avg_loss=0.002764
epoch=331, avg_loss=0.002737
epoch=332, avg_loss=0.002773
epoch=333, avg_loss=0.002748
epoch=334, avg_loss=0.002724
epoch=335, avg_loss=0.002752
epoch=336, avg_loss=0.002774
epoch=337, avg_loss=0.002710
epoch=338, avg_loss=0.002726
epoch=339, avg_loss=0.002712
epoch=340, avg_loss=0.002739
epoch=341, avg_loss=0.002720
epoch=342, avg_loss=0.002774
epoch=343, avg_loss=0.002720
epoch=344, avg_loss=0.002692
epoch=345, avg_loss=0.002715
epoch=346, avg_loss=0.002738
epoch=347, avg_loss=0.002749
epoch=348, avg_loss=0.002676
epoch=349, avg_loss=0.002742
epoch=350, avg_loss=0.002717
epoch=351, avg_loss=0.002687
epoch=352, avg_loss=0.002697
epoch=353, avg_loss=0.002705
epoch=354, avg_loss=0.002703
epoch=355, avg_loss=0.002703
epoch=356, avg_loss=0.002671
epoch=357, avg_loss=0.002691
epoch=358, avg_loss=0.002690
epoch=359, avg_loss=0.002701
epoch=360, avg_loss=0.002694
epoch=361, avg_loss=0.002696
epoch=362, avg_loss=0.002683
epoch=363, avg_loss=0.002675
epoch=364, avg_loss=0.002698
epoch=365, avg_loss=0.002686
epoch=366, avg_loss=0.002705
epoch=367, avg_loss=0.002689
epoch=368, avg_loss=0.002666
epoch=369, avg_loss=0.002694
epoch=370, avg_loss=0.002661
epoch=371, avg_loss=0.002663
epoch=372, avg_loss=0.002690
epoch=373, avg_loss=0.002662
epoch=374, avg_loss=0.002696
epoch=375, avg_loss=0.002661
epoch=376, avg_loss=0.002675
epoch=377, avg_loss=0.002655
epoch=378, avg_loss=0.002649
epoch=379, avg_loss=0.002655
epoch=380, avg_loss=0.002670
epoch=381, avg_loss=0.002647
epoch=382, avg_loss=0.002665
epoch=383, avg_loss=0.002652
epoch=384, avg_loss=0.002650
epoch=385, avg_loss=0.002660
epoch=386, avg_loss=0.002653
epoch=387, avg_loss=0.002635
epoch=388, avg_loss=0.002660
epoch=389, avg_loss=0.002656
epoch=390, avg_loss=0.002625
epoch=391, avg_loss=0.002624
epoch=392, avg_loss=0.002638
epoch=393, avg_loss=0.002642
epoch=394, avg_loss=0.002612
epoch=395, avg_loss=0.002644
epoch=396, avg_loss=0.002641
epoch=397, avg_loss=0.002612
epoch=398, avg_loss=0.002609
epoch=399, avg_loss=0.002623
epoch=400, avg_loss=0.002606
epoch=401, avg_loss=0.002624
epoch=402, avg_loss=0.002620
epoch=403, avg_loss=0.002610
epoch=404, avg_loss=0.002641
epoch=405, avg_loss=0.002617
epoch=406, avg_loss=0.002600
epoch=407, avg_loss=0.002605
epoch=408, avg_loss=0.002612
epoch=409, avg_loss=0.002605
epoch=410, avg_loss=0.002606
epoch=411, avg_loss=0.002619
epoch=412, avg_loss=0.002614
epoch=413, avg_loss=0.002611
epoch=414, avg_loss=0.002583
epoch=415, avg_loss=0.002608
epoch=416, avg_loss=0.002599
epoch=417, avg_loss=0.002597
epoch=418, avg_loss=0.002592
epoch=419, avg_loss=0.002605
epoch=420, avg_loss=0.002574
epoch=421, avg_loss=0.002598
epoch=422, avg_loss=0.002582
epoch=423, avg_loss=0.002603
epoch=424, avg_loss=0.002580
epoch=425, avg_loss=0.002573
epoch=426, avg_loss=0.002587
epoch=427, avg_loss=0.002597
epoch=428, avg_loss=0.002575
epoch=429, avg_loss=0.002586
epoch=430, avg_loss=0.002574
epoch=431, avg_loss=0.002584
epoch=432, avg_loss=0.002579
epoch=433, avg_loss=0.002558
epoch=434, avg_loss=0.002578
epoch=435, avg_loss=0.002576
epoch=436, avg_loss=0.002558
epoch=437, avg_loss=0.002561
epoch=438, avg_loss=0.002566
epoch=439, avg_loss=0.002559
epoch=440, avg_loss=0.002562
epoch=441, avg_loss=0.002561
epoch=442, avg_loss=0.002555
epoch=443, avg_loss=0.002563
epoch=444, avg_loss=0.002558
epoch=445, avg_loss=0.002569
epoch=446, avg_loss=0.002544
epoch=447, avg_loss=0.002552
epoch=448, avg_loss=0.002557
epoch=449, avg_loss=0.002572
epoch=450, avg_loss=0.002540
epoch=451, avg_loss=0.002542
epoch=452, avg_loss=0.002544
epoch=453, avg_loss=0.002542
epoch=454, avg_loss=0.002538
epoch=455, avg_loss=0.002534
epoch=456, avg_loss=0.002548
epoch=457, avg_loss=0.002537
epoch=458, avg_loss=0.002530
epoch=459, avg_loss=0.002535
epoch=460, avg_loss=0.002543
epoch=461, avg_loss=0.002521
epoch=462, avg_loss=0.002529
epoch=463, avg_loss=0.002548
epoch=464, avg_loss=0.002519
epoch=465, avg_loss=0.002532
epoch=466, avg_loss=0.002525
epoch=467, avg_loss=0.002544
epoch=468, avg_loss=0.002519
epoch=469, avg_loss=0.002505
epoch=470, avg_loss=0.002521
epoch=471, avg_loss=0.002523
epoch=472, avg_loss=0.002527
epoch=473, avg_loss=0.002514
epoch=474, avg_loss=0.002531
epoch=475, avg_loss=0.002516
epoch=476, avg_loss=0.002518
epoch=477, avg_loss=0.002504
epoch=478, avg_loss=0.002505
epoch=479, avg_loss=0.002506
epoch=480, avg_loss=0.002513
epoch=481, avg_loss=0.002505
epoch=482, avg_loss=0.002498
epoch=483, avg_loss=0.002505
epoch=484, avg_loss=0.002501
epoch=485, avg_loss=0.002514
epoch=486, avg_loss=0.002489
epoch=487, avg_loss=0.002491
epoch=488, avg_loss=0.002503
epoch=489, avg_loss=0.002503
epoch=490, avg_loss=0.002495
epoch=491, avg_loss=0.002491
epoch=492, avg_loss=0.002479
epoch=493, avg_loss=0.002485
epoch=494, avg_loss=0.002481
epoch=495, avg_loss=0.002488
epoch=496, avg_loss=0.002486
epoch=497, avg_loss=0.002469
epoch=498, avg_loss=0.002493
epoch=499, avg_loss=0.002477
epoch=500, avg_loss=0.002478
epoch=501, avg_loss=0.002470
epoch=502, avg_loss=0.002476
epoch=503, avg_loss=0.002487
epoch=504, avg_loss=0.002484
epoch=505, avg_loss=0.002475
epoch=506, avg_loss=0.002478
epoch=507, avg_loss=0.002467
epoch=508, avg_loss=0.002509
epoch=509, avg_loss=0.002460
epoch=510, avg_loss=0.002469
epoch=511, avg_loss=0.002466
epoch=512, avg_loss=0.002458
epoch=513, avg_loss=0.002472
epoch=514, avg_loss=0.002450
epoch=515, avg_loss=0.002454
epoch=516, avg_loss=0.002466
epoch=517, avg_loss=0.002462
epoch=518, avg_loss=0.002449
epoch=519, avg_loss=0.002451
epoch=520, avg_loss=0.002450
epoch=521, avg_loss=0.002453
epoch=522, avg_loss=0.002452
epoch=523, avg_loss=0.002439
epoch=524, avg_loss=0.002465
epoch=525, avg_loss=0.002442
epoch=526, avg_loss=0.002451
epoch=527, avg_loss=0.002448
epoch=528, avg_loss=0.002445
epoch=529, avg_loss=0.002442
epoch=530, avg_loss=0.002438
epoch=531, avg_loss=0.002447
epoch=532, avg_loss=0.002445
epoch=533, avg_loss=0.002435
epoch=534, avg_loss=0.002440
epoch=535, avg_loss=0.002430
epoch=536, avg_loss=0.002433
epoch=537, avg_loss=0.002438
epoch=538, avg_loss=0.002431
epoch=539, avg_loss=0.002437
epoch=540, avg_loss=0.002423
epoch=541, avg_loss=0.002437
epoch=542, avg_loss=0.002433
epoch=543, avg_loss=0.002424
epoch=544, avg_loss=0.002421
epoch=545, avg_loss=0.002425
epoch=546, avg_loss=0.002422
epoch=547, avg_loss=0.002423
epoch=548, avg_loss=0.002418
epoch=549, avg_loss=0.002423
epoch=550, avg_loss=0.002423
epoch=551, avg_loss=0.002416
epoch=552, avg_loss=0.002411
epoch=553, avg_loss=0.002419
epoch=554, avg_loss=0.002413
epoch=555, avg_loss=0.002417
epoch=556, avg_loss=0.002415
epoch=557, avg_loss=0.002409
epoch=558, avg_loss=0.002415
epoch=559, avg_loss=0.002410
epoch=560, avg_loss=0.002404
epoch=561, avg_loss=0.002404
epoch=562, avg_loss=0.002407
epoch=563, avg_loss=0.002399
epoch=564, avg_loss=0.002406
epoch=565, avg_loss=0.002398
epoch=566, avg_loss=0.002397
epoch=567, avg_loss=0.002398
epoch=568, avg_loss=0.002400
epoch=569, avg_loss=0.002394
epoch=570, avg_loss=0.002399
epoch=571, avg_loss=0.002398
epoch=572, avg_loss=0.002397
epoch=573, avg_loss=0.002389
epoch=574, avg_loss=0.002393
epoch=575, avg_loss=0.002392
epoch=576, avg_loss=0.002391
epoch=577, avg_loss=0.002386
epoch=578, avg_loss=0.002389
epoch=579, avg_loss=0.002383
epoch=580, avg_loss=0.002388
epoch=581, avg_loss=0.002377
epoch=582, avg_loss=0.002386
epoch=583, avg_loss=0.002383
epoch=584, avg_loss=0.002380
epoch=585, avg_loss=0.002375
epoch=586, avg_loss=0.002377
epoch=587, avg_loss=0.002378
epoch=588, avg_loss=0.002379
epoch=589, avg_loss=0.002375
epoch=590, avg_loss=0.002376
epoch=591, avg_loss=0.002378
epoch=592, avg_loss=0.002370
epoch=593, avg_loss=0.002368
epoch=594, avg_loss=0.002369
epoch=595, avg_loss=0.002364
epoch=596, avg_loss=0.002371
epoch=597, avg_loss=0.002370
epoch=598, avg_loss=0.002369
epoch=599, avg_loss=0.002359
epoch=600, avg_loss=0.002362
epoch=601, avg_loss=0.002362
epoch=602, avg_loss=0.002363
epoch=603, avg_loss=0.002361
epoch=604, avg_loss=0.002363
epoch=605, avg_loss=0.002364
epoch=606, avg_loss=0.002358
epoch=607, avg_loss=0.002361
epoch=608, avg_loss=0.002358
epoch=609, avg_loss=0.002357
epoch=610, avg_loss=0.002356
epoch=611, avg_loss=0.002354
epoch=612, avg_loss=0.002361
epoch=613, avg_loss=0.002347
epoch=614, avg_loss=0.002352
epoch=615, avg_loss=0.002352
epoch=616, avg_loss=0.002348
epoch=617, avg_loss=0.002344
epoch=618, avg_loss=0.002343
epoch=619, avg_loss=0.002345
epoch=620, avg_loss=0.002340
epoch=621, avg_loss=0.002342
epoch=622, avg_loss=0.002344
epoch=623, avg_loss=0.002342
epoch=624, avg_loss=0.002336
epoch=625, avg_loss=0.002339
epoch=626, avg_loss=0.002333
epoch=627, avg_loss=0.002335
epoch=628, avg_loss=0.002341
epoch=629, avg_loss=0.002336
epoch=630, avg_loss=0.002336
epoch=631, avg_loss=0.002338
epoch=632, avg_loss=0.002334
epoch=633, avg_loss=0.002331
epoch=634, avg_loss=0.002333
epoch=635, avg_loss=0.002327
epoch=636, avg_loss=0.002336
epoch=637, avg_loss=0.002326
epoch=638, avg_loss=0.002332
epoch=639, avg_loss=0.002325
epoch=640, avg_loss=0.002326
epoch=641, avg_loss=0.002324
epoch=642, avg_loss=0.002322
epoch=643, avg_loss=0.002322
epoch=644, avg_loss=0.002320
epoch=645, avg_loss=0.002319
epoch=646, avg_loss=0.002315
epoch=647, avg_loss=0.002320
epoch=648, avg_loss=0.002316
epoch=649, avg_loss=0.002319
epoch=650, avg_loss=0.002318
epoch=651, avg_loss=0.002316
epoch=652, avg_loss=0.002317
epoch=653, avg_loss=0.002312
epoch=654, avg_loss=0.002318
epoch=655, avg_loss=0.002309
epoch=656, avg_loss=0.002310
epoch=657, avg_loss=0.002310
epoch=658, avg_loss=0.002310
epoch=659, avg_loss=0.002306
epoch=660, avg_loss=0.002305
epoch=661, avg_loss=0.002305
epoch=662, avg_loss=0.002309
epoch=663, avg_loss=0.002302
epoch=664, avg_loss=0.002303
epoch=665, avg_loss=0.002307
epoch=666, avg_loss=0.002299
epoch=667, avg_loss=0.002299
epoch=668, avg_loss=0.002302
epoch=669, avg_loss=0.002301
epoch=670, avg_loss=0.002299
epoch=671, avg_loss=0.002296
epoch=672, avg_loss=0.002298
epoch=673, avg_loss=0.002298
epoch=674, avg_loss=0.002289
epoch=675, avg_loss=0.002294
epoch=676, avg_loss=0.002294
epoch=677, avg_loss=0.002291
epoch=678, avg_loss=0.002290
epoch=679, avg_loss=0.002289
epoch=680, avg_loss=0.002287
epoch=681, avg_loss=0.002289
epoch=682, avg_loss=0.002287
epoch=683, avg_loss=0.002290
epoch=684, avg_loss=0.002282
epoch=685, avg_loss=0.002287
epoch=686, avg_loss=0.002284
epoch=687, avg_loss=0.002283
epoch=688, avg_loss=0.002283
epoch=689, avg_loss=0.002285
epoch=690, avg_loss=0.002283
epoch=691, avg_loss=0.002281
epoch=692, avg_loss=0.002284
epoch=693, avg_loss=0.002281
epoch=694, avg_loss=0.002277
epoch=695, avg_loss=0.002275
epoch=696, avg_loss=0.002277
epoch=697, avg_loss=0.002272
epoch=698, avg_loss=0.002276
epoch=699, avg_loss=0.002273
epoch=700, avg_loss=0.002272
epoch=701, avg_loss=0.002275
epoch=702, avg_loss=0.002272
epoch=703, avg_loss=0.002271
epoch=704, avg_loss=0.002269
epoch=705, avg_loss=0.002269
epoch=706, avg_loss=0.002269
epoch=707, avg_loss=0.002268
epoch=708, avg_loss=0.002265
epoch=709, avg_loss=0.002266
epoch=710, avg_loss=0.002267
epoch=711, avg_loss=0.002263
epoch=712, avg_loss=0.002268
epoch=713, avg_loss=0.002269
epoch=714, avg_loss=0.002265
epoch=715, avg_loss=0.002265
epoch=716, avg_loss=0.002258
epoch=717, avg_loss=0.002257
epoch=718, avg_loss=0.002261
epoch=719, avg_loss=0.002257
epoch=720, avg_loss=0.002260
epoch=721, avg_loss=0.002259
epoch=722, avg_loss=0.002259
epoch=723, avg_loss=0.002255
epoch=724, avg_loss=0.002255
epoch=725, avg_loss=0.002252
epoch=726, avg_loss=0.002251
epoch=727, avg_loss=0.002252
epoch=728, avg_loss=0.002255
epoch=729, avg_loss=0.002252
epoch=730, avg_loss=0.002248
epoch=731, avg_loss=0.002253
epoch=732, avg_loss=0.002251
epoch=733, avg_loss=0.002249
epoch=734, avg_loss=0.002251
epoch=735, avg_loss=0.002248
epoch=736, avg_loss=0.002246
epoch=737, avg_loss=0.002248
epoch=738, avg_loss=0.002246
epoch=739, avg_loss=0.002247
epoch=740, avg_loss=0.002248
epoch=741, avg_loss=0.002240
epoch=742, avg_loss=0.002246
epoch=743, avg_loss=0.002240
epoch=744, avg_loss=0.002240
epoch=745, avg_loss=0.002241
epoch=746, avg_loss=0.002238
epoch=747, avg_loss=0.002236
epoch=748, avg_loss=0.002241
epoch=749, avg_loss=0.002236
epoch=750, avg_loss=0.002238
epoch=751, avg_loss=0.002236
epoch=752, avg_loss=0.002237
epoch=753, avg_loss=0.002233
epoch=754, avg_loss=0.002235
epoch=755, avg_loss=0.002231
epoch=756, avg_loss=0.002233
epoch=757, avg_loss=0.002233
epoch=758, avg_loss=0.002233
epoch=759, avg_loss=0.002230
epoch=760, avg_loss=0.002229
epoch=761, avg_loss=0.002227
epoch=762, avg_loss=0.002228
epoch=763, avg_loss=0.002228
epoch=764, avg_loss=0.002229
epoch=765, avg_loss=0.002229
epoch=766, avg_loss=0.002228
epoch=767, avg_loss=0.002227
epoch=768, avg_loss=0.002222
epoch=769, avg_loss=0.002226
epoch=770, avg_loss=0.002226
epoch=771, avg_loss=0.002225
epoch=772, avg_loss=0.002224
epoch=773, avg_loss=0.002220
epoch=774, avg_loss=0.002220
epoch=775, avg_loss=0.002220
epoch=776, avg_loss=0.002224
epoch=777, avg_loss=0.002220
epoch=778, avg_loss=0.002221
epoch=779, avg_loss=0.002220
epoch=780, avg_loss=0.002217
epoch=781, avg_loss=0.002215
epoch=782, avg_loss=0.002218
epoch=783, avg_loss=0.002215
epoch=784, avg_loss=0.002221
epoch=785, avg_loss=0.002217
epoch=786, avg_loss=0.002216
epoch=787, avg_loss=0.002218
epoch=788, avg_loss=0.002219
epoch=789, avg_loss=0.002215
epoch=790, avg_loss=0.002216
epoch=791, avg_loss=0.002214
epoch=792, avg_loss=0.002215
epoch=793, avg_loss=0.002215
epoch=794, avg_loss=0.002210
epoch=795, avg_loss=0.002214
epoch=796, avg_loss=0.002210
epoch=797, avg_loss=0.002211
epoch=798, avg_loss=0.002211
epoch=799, avg_loss=0.002208
epoch=800, avg_loss=0.002208
epoch=801, avg_loss=0.002209
epoch=802, avg_loss=0.002208
epoch=803, avg_loss=0.002207
epoch=804, avg_loss=0.002207
epoch=805, avg_loss=0.002206
epoch=806, avg_loss=0.002206
epoch=807, avg_loss=0.002205
epoch=808, avg_loss=0.002208
epoch=809, avg_loss=0.002201
epoch=810, avg_loss=0.002205
epoch=811, avg_loss=0.002207
epoch=812, avg_loss=0.002204
epoch=813, avg_loss=0.002203
epoch=814, avg_loss=0.002204
epoch=815, avg_loss=0.002202
epoch=816, avg_loss=0.002199
epoch=817, avg_loss=0.002201
epoch=818, avg_loss=0.002199
epoch=819, avg_loss=0.002198
epoch=820, avg_loss=0.002200
epoch=821, avg_loss=0.002198
epoch=822, avg_loss=0.002197
epoch=823, avg_loss=0.002199
epoch=824, avg_loss=0.002196
epoch=825, avg_loss=0.002197
epoch=826, avg_loss=0.002197
epoch=827, avg_loss=0.002195
epoch=828, avg_loss=0.002196
epoch=829, avg_loss=0.002197
epoch=830, avg_loss=0.002197
epoch=831, avg_loss=0.002195
epoch=832, avg_loss=0.002188
epoch=833, avg_loss=0.002195
epoch=834, avg_loss=0.002192
epoch=835, avg_loss=0.002191
epoch=836, avg_loss=0.002192
epoch=837, avg_loss=0.002192
epoch=838, avg_loss=0.002192
epoch=839, avg_loss=0.002191
epoch=840, avg_loss=0.002186
epoch=841, avg_loss=0.002188
epoch=842, avg_loss=0.002190
epoch=843, avg_loss=0.002187
epoch=844, avg_loss=0.002191
epoch=845, avg_loss=0.002190
epoch=846, avg_loss=0.002185
epoch=847, avg_loss=0.002190
epoch=848, avg_loss=0.002186
epoch=849, avg_loss=0.002186
epoch=850, avg_loss=0.002189
epoch=851, avg_loss=0.002188
epoch=852, avg_loss=0.002184
epoch=853, avg_loss=0.002187
epoch=854, avg_loss=0.002184
epoch=855, avg_loss=0.002186
epoch=856, avg_loss=0.002184
epoch=857, avg_loss=0.002185
epoch=858, avg_loss=0.002185
epoch=859, avg_loss=0.002179
epoch=860, avg_loss=0.002182
epoch=861, avg_loss=0.002184
epoch=862, avg_loss=0.002184
epoch=863, avg_loss=0.002181
epoch=864, avg_loss=0.002178
epoch=865, avg_loss=0.002183
epoch=866, avg_loss=0.002184
epoch=867, avg_loss=0.002179
epoch=868, avg_loss=0.002180
epoch=869, avg_loss=0.002183
epoch=870, avg_loss=0.002181
epoch=871, avg_loss=0.002178
epoch=872, avg_loss=0.002181
epoch=873, avg_loss=0.002177
epoch=874, avg_loss=0.002179
epoch=875, avg_loss=0.002180
epoch=876, avg_loss=0.002178
epoch=877, avg_loss=0.002174
epoch=878, avg_loss=0.002176
epoch=879, avg_loss=0.002180
epoch=880, avg_loss=0.002178
epoch=881, avg_loss=0.002174
epoch=882, avg_loss=0.002174
epoch=883, avg_loss=0.002176
epoch=884, avg_loss=0.002178
epoch=885, avg_loss=0.002174
epoch=886, avg_loss=0.002173
epoch=887, avg_loss=0.002174
epoch=888, avg_loss=0.002171
epoch=889, avg_loss=0.002171
epoch=890, avg_loss=0.002173
epoch=891, avg_loss=0.002172
epoch=892, avg_loss=0.002173
epoch=893, avg_loss=0.002174
epoch=894, avg_loss=0.002168
epoch=895, avg_loss=0.002172
epoch=896, avg_loss=0.002170
epoch=897, avg_loss=0.002173
epoch=898, avg_loss=0.002171
epoch=899, avg_loss=0.002172
epoch=900, avg_loss=0.002168
epoch=901, avg_loss=0.002169
epoch=902, avg_loss=0.002173
epoch=903, avg_loss=0.002171
epoch=904, avg_loss=0.002167
epoch=905, avg_loss=0.002171
epoch=906, avg_loss=0.002170
epoch=907, avg_loss=0.002169
epoch=908, avg_loss=0.002169
epoch=909, avg_loss=0.002167
epoch=910, avg_loss=0.002170
epoch=911, avg_loss=0.002171
epoch=912, avg_loss=0.002171
epoch=913, avg_loss=0.002167
epoch=914, avg_loss=0.002167
epoch=915, avg_loss=0.002170
epoch=916, avg_loss=0.002167
epoch=917, avg_loss=0.002168
epoch=918, avg_loss=0.002173
epoch=919, avg_loss=0.002166
epoch=920, avg_loss=0.002166
epoch=921, avg_loss=0.002170
epoch=922, avg_loss=0.002166
epoch=923, avg_loss=0.002165
epoch=924, avg_loss=0.002171
epoch=925, avg_loss=0.002165
epoch=926, avg_loss=0.002166
epoch=927, avg_loss=0.002168
epoch=928, avg_loss=0.002164
epoch=929, avg_loss=0.002166
epoch=930, avg_loss=0.002167
epoch=931, avg_loss=0.002167
epoch=932, avg_loss=0.002164
epoch=933, avg_loss=0.002166
epoch=934, avg_loss=0.002164
epoch=935, avg_loss=0.002167
epoch=936, avg_loss=0.002166
epoch=937, avg_loss=0.002168
epoch=938, avg_loss=0.002163
epoch=939, avg_loss=0.002165
epoch=940, avg_loss=0.002161
epoch=941, avg_loss=0.002164
epoch=942, avg_loss=0.002162
epoch=943, avg_loss=0.002162
epoch=944, avg_loss=0.002166
epoch=945, avg_loss=0.002164
epoch=946, avg_loss=0.002165
epoch=947, avg_loss=0.002164
epoch=948, avg_loss=0.002161
epoch=949, avg_loss=0.002164
epoch=950, avg_loss=0.002164
epoch=951, avg_loss=0.002156
epoch=952, avg_loss=0.002165
epoch=953, avg_loss=0.002164
epoch=954, avg_loss=0.002162
epoch=955, avg_loss=0.002162
epoch=956, avg_loss=0.002164
epoch=957, avg_loss=0.002155
epoch=958, avg_loss=0.002163
epoch=959, avg_loss=0.002160
epoch=960, avg_loss=0.002161
epoch=961, avg_loss=0.002162
epoch=962, avg_loss=0.002164
epoch=963, avg_loss=0.002159
epoch=964, avg_loss=0.002164
epoch=965, avg_loss=0.002161
epoch=966, avg_loss=0.002159
epoch=967, avg_loss=0.002162
epoch=968, avg_loss=0.002161
epoch=969, avg_loss=0.002160
epoch=970, avg_loss=0.002160
epoch=971, avg_loss=0.002160
epoch=972, avg_loss=0.002159
epoch=973, avg_loss=0.002161
epoch=974, avg_loss=0.002161
epoch=975, avg_loss=0.002159
epoch=976, avg_loss=0.002157
epoch=977, avg_loss=0.002159
epoch=978, avg_loss=0.002157
epoch=979, avg_loss=0.002161
epoch=980, avg_loss=0.002162
epoch=981, avg_loss=0.002161
epoch=982, avg_loss=0.002160
epoch=983, avg_loss=0.002159
epoch=984, avg_loss=0.002159
epoch=985, avg_loss=0.002160
epoch=986, avg_loss=0.002159
epoch=987, avg_loss=0.002160
epoch=988, avg_loss=0.002157
epoch=989, avg_loss=0.002159
"""

# Extract epoch and avg_loss pairs
pattern = r"epoch=(\d+), avg_loss=([\d.]+)"
matches = re.findall(pattern, log_data)

losses = defaultdict(list)
for e, l in matches:
    losses[int(e)].append(float(l))

# Compute average per epoch
x_1 = sorted(losses.keys())
y_1 = [np.mean(losses[e]) for e in x_1]
"""
log_data = """
"""

# Extract epoch and avg_loss pairs
pattern = r"epoch=(\d+), avg_loss=([\d.]+)"
matches = re.findall(pattern, log_data)

losses = defaultdict(list)
for e, l in matches:
    losses[int(e)].append(float(l))

# Compute average per epoch
x_2 = sorted(losses.keys())
y_2 = [np.mean(losses[e]) for e in x_1]
"""
"""
x_1 = [i for i in range(151)]
y_1 = [0.107844, 0.023998, 0.013476, 0.011566, 0.009960, 0.009663, 0.008860, 0.008745, 0.008228, 0.008052, 
       0.007581, 0.007299, 0.007170, 0.007098, 0.006995, 0.006840, 0.006901, 0.006583, 0.006600, 0.006528, 
       0.006425, 0.006233, 0.006181, 0.006037, 0.006021, 0.006010, 0.005831, 0.005760, 0.005829, 0.005670, 
       0.005597, 0.005582, 0.005554, 0.005467, 0.005391, 0.005311, 0.005303, 0.005159, 0.005220, 0.005088, 
       0.005141, 0.005046, 0.005024, 0.005035, 0.004970, 0.004979, 0.004897, 0.004930, 0.004874, 0.004821, 
       0.004813, 0.004841, 0.004715, 0.004768, 0.004649, 0.004762, 0.004684, 0.004719, 0.004592, 0.004552, 
       0.004580, 0.004505, 0.004555, 0.004486, 0.004500, 0.004416, 0.004447, 0.004401, 0.004473, 0.004338, 
       0.004363, 0.004340, 0.004314, 0.004309, 0.004325, 0.004286, 0.004250, 0.004272, 0.004214, 0.004196, 
       0.004189, 0.004143, 0.004207, 0.004154, 0.004155, 0.004117, 0.004092, 0.004093, 0.004082, 0.004064, 
       0.004073, 0.004053, 0.004013, 0.004024, 0.004012, 0.004006, 0.003998, 0.003978, 0.003968, 0.003936, 
       0.003940, 0.003933, 0.003919, 0.003901, 0.003890, 0.003887, 0.003873, 0.003866, 0.003847, 0.003862, 
       0.003843, 0.003830, 0.003823, 0.003807, 0.003807, 0.003803, 0.003785, 0.003775, 0.003766, 0.003774, 
       0.003750, 0.003751, 0.003737, 0.003727, 0.003728, 0.003722, 0.003717, 0.003705, 0.003704, 0.003708, 
       0.003697, 0.003682, 0.003685, 0.003670, 0.003670, 0.003660, 0.003662, 0.003651, 0.003651, 0.003648, 
       0.003645, 0.003639, 0.003628, 0.003632, 0.003625, 0.003620, 0.003626, 0.003616, 0.003613, 0.003608, 
       0.003610]

x_2 = [i for i in range(151)]
y_2 = [0.384471, 0.384389, 0.384258, 0.384124, 0.383739, 0.382950, 0.381199, 0.376176, 0.359513, 0.284475,
       0.123835, 0.079901, 0.035968, 0.017340, 0.012128, 0.011576, 0.011498, 0.011324, 0.011093, 0.011345,
       0.011058, 0.010763, 0.009917, 0.009313, 0.008835, 0.008348, 0.008286, 0.008192, 0.007771, 0.007865,
       0.007640, 0.007326, 0.007213, 0.007187, 0.007215, 0.006739, 0.006681, 0.006512, 0.006474, 0.006274,
       0.006311, 0.005984, 0.005851, 0.005914, 0.005691, 0.005719, 0.005512, 0.005687, 0.005591, 0.005460,
       0.005316, 0.005472, 0.005215, 0.005216, 0.005112, 0.005215, 0.005030, 0.005072, 0.004970, 0.004834,
       0.004903, 0.004804, 0.004773, 0.004736, 0.004692, 0.004653, 0.004659, 0.004587, 0.004635, 0.004482,
       0.004456, 0.004512, 0.004431, 0.004406, 0.004353, 0.004381, 0.004286, 0.004272, 0.004219, 0.004248,
       0.004219, 0.004160, 0.004205, 0.004144, 0.004076, 0.004088, 0.004063, 0.004053, 0.003979, 0.004014,
       0.004025, 0.003936, 0.003950, 0.003895, 0.003905, 0.003881, 0.003845, 0.003844, 0.003800, 0.003783,
       0.003773, 0.003730, 0.003746, 0.003700, 0.003694, 0.003688, 0.003663, 0.003653, 0.003634, 0.003629,
       0.003593, 0.003592, 0.003576, 0.003566, 0.003534, 0.003539, 0.003535, 0.003515, 0.003498, 0.003509,
       0.003459, 0.003482, 0.003453, 0.003442, 0.003436, 0.003431, 0.003408, 0.003407, 0.003394, 0.003396,
       0.003383, 0.003372, 0.003365, 0.003352, 0.003341, 0.003337, 0.003337, 0.003315, 0.003316, 0.003320,
       0.003300, 0.003300, 0.003288, 0.003290, 0.003278, 0.003269, 0.003279, 0.003261, 0.003254, 0.003250,
       0.003253]
"""
# Plot both
plt.figure(figsize=(8, 5))
#plt.plot(x_2, y_2, marker='o', linewidth=2, markersize=5, label='Bentheimer-initialized')
plt.plot(x_1, y_1, marker='s', linewidth=2, markersize=5, label='Bentheimer-normal')

# Labels and style
#plt.title("Average Loss per Epoch", fontsize=14)
plt.xlabel("Epoch", fontsize=12)
plt.ylabel("Average Loss", fontsize=12)
plt.grid(True, linestyle='--', alpha=0.6)
plt.legend()
plt.tight_layout()
plt.show()